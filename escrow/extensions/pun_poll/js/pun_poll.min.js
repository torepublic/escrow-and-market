PUNBB.pun_poll=(function(){function f(g){return(g&&g.offsetWidth!==0);}function b(g){return document.getElementById(g);}function a(){var i=b("pun_poll_form_block"),h=b("pun_poll_switcher_link"),g=b("pun_poll_block_status");if(!i||!h||!g){return true;}if(!f(i)){i.style.display="block";h.innerHTML=h.getAttribute("data-lang-hide");g.value="1";}else{i.style.display="none";h.innerHTML=h.getAttribute("data-lang-show");g.value="0";}return false;}function d(){var q=b("pun_poll_add_option_template"),n="",h,p,j=0,o=0,k,m,l;if(!q){return true;}n=document.createElement("div");PUNBB.common.addClass(n,"sf-set");n.innerHTML=q.innerHTML;k=document.getElementsByTagName("div");for(h=0,p=k.length;h<p;h+=1){var g=k[h];if(g.getAttribute("data-item-count")!==null&&g.getAttribute("data-fld-count")!==null){if(g.getAttribute("data-item-count")>o){o=parseInt(g.getAttribute("data-item-count"),10);}if(g.getAttribute("data-fld-count")>j){j=parseInt(g.getAttribute("data-fld-count"),10);}}}j+=1;n.setAttribute("data-fld-count",j.toString());o+=1;PUNBB.common.addClass(n,"set"+o.toString());n.setAttribute("data-item-count",o.toString());m=n.getElementsByTagName("label")[0];l=n.getElementsByTagName("input")[0];m.setAttribute("for","fld"+j.toString());l.setAttribute("id","fld"+j.toString());q.parentNode.insertBefore(n,q);l.focus();return false;}function e(){var i,g;var h=function(j){return(PUNBB.common.hasClass(j,"pun_poll_item")&&PUNBB.common.hasClass(j,"unvotted"));};i=PUNBB.common.arrayOfMatched(h,document.getElementsByTagName("div"));PUNBB.common.map(c,i);}function c(g){var j,h,i;i=function(l,k){return function(){var m=PUNBB.common.arrayOfMatched(function(n){return(n.type==="radio"&&n.name&&n.name==="answer"&&n.checked);},l.getElementsByTagName("input"));if(m.length>0){h.removeAttribute("disabled");}else{h.setAttribute("disabled","disabled");}};};h=PUNBB.common.arrayOfMatched(function(k){return(k.type==="submit"&&k.name&&k.name==="vote");},g.getElementsByTagName("input"))[0];j=PUNBB.common.arrayOfMatched(function(k){return(k.type==="radio"&&k.name&&k.name==="answer");},g.getElementsByTagName("input"));if(h&&j.length>0){PUNBB.common.map(function(k){k.onchange=i(g,h);},j);i(g,h)();}}return{init:function(){if(PUNBB.env.page==="post"||PUNBB.env.page==="postedit"){var h=b("pun_poll_switcher_link"),g=b("pun_poll_block_status"),i=b("pun_poll_add_options_link");if(h){h.onclick=a;}if(g){g.value=f(b("pun_poll_form_block"))?"1":"0";}if(i){i.onclick=d;}}if(PUNBB.env.page==="viewtopic"){e();}}};}());PUNBB.common.addDOMReadyEvent(PUNBB.pun_poll.init);